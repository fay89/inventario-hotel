<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <link rel="stylesheet" href="/style.css" />
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#1d72b8" />
</head>
<body>
  <h1>ğŸ“Š Dashboard del Inventario</h1>

  <% if (user) { %>
    <p>Bienvenido, <strong><%= user.name %></strong> | <a href="/logout">Cerrar sesiÃ³n</a></p>
    <p><a href="/inventory">â† Volver al Inventario</a></p>

    <div style="text-align: center;">
      <h3>ğŸ“¦ Resumen general</h3>
      <ul>
        <li><strong>Total de productos:</strong> <%= stats.totalProductos %></li>
        <li><strongTotal unidades en stock:</strong> <%= stats.totalUnidades %></li>
      </ul>

      <h3>âš ï¸ Productos con stock bajo</h3>
      <% if (stats.productosBajoStock.length === 0) { %>
        <p>No hay productos con stock bajo. ğŸ‰</p>
      <% } else { %>
        <ul>
          <% stats.productosBajoStock.forEach(p => { %>
            <li><%= p.name %> â€” <%= p.quantity %> unidades</li>
          <% }) %>
        </ul>
      <% } %>

      <h3>ğŸ”¥ Productos mÃ¡s usados</h3>
      <% if (stats.productosMasUsados.length === 0) { %>
        <p>AÃºn no hay movimientos registrados.</p>
      <% } else { %>
        <ol>
          <% stats.productosMasUsados.forEach(p => { %>
            <li><%= p.name %> â€” <%= p.movimientos %> movimientos</li>
          <% }) %>
        </ol>
      <% } %>
    </div>

  <% } else { %>
    <p><a href="/login">Iniciar sesiÃ³n</a> para ver el dashboard.</p>
  <% } %>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js');
    }
  </script>
</body>
</html>
